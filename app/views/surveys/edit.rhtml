<% if authorize_for('surveys', 'edit') %>
  <% form_for :survey, @survey, :url => {:controller => 'surveys', :action => 'update', :project_id => @project, :id => @survey}, :html => {:id => 'survey-form'} do |f| %>
     <%= render :partial => 'surveys/form', :locals => {:f => f} %>
    <p><%= submit_tag l(:button_change) %>
<%= link_to_remote l(:label_preview), 
  { :url => { :controller => 'surveys', :action => 'preview' },
    :method => 'post',
    :update => 'preview',
    :with => "Form.serialize('survey-form')",
    :complete => "Element.scrollTo('preview')"
  }, :accesskey => accesskey(:preview) %> |
<%= link_to l(:button_cancel), {:action => 'show', :id => @survey } %></p>
  <% end %>
<div id="preview" class="wiki"></div>
 <% end %>

